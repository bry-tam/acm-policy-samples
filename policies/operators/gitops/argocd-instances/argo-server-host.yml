---
object-templates-raw: |
  {{/* ##  Get all the argoCD instances ## */}}
  {{- range $argo := (lookup "argoproj.io/v1beta1" "ArgoCD" "" "").items }}
    {{- $rt := (lookup "route.openshift.io/v1" "Route" $argo.metadata.namespace (printf "%s-server" $argo.metadata.name)) }}

    {{/* ##  set the server host to match the route ## */}}
    {{- if $rt }}
  - complianceType: musthave
    objectDefinition:
      apiVersion: argoproj.io/v1beta1
      kind: ArgoCD
      metadata:
        name: {{ $argo.metadata.name }}
        namespace: {{ $argo.metadata.namespace }}
      spec:
        server:
          host: {{ $rt.spec.host }}
    {{- end }}
  {{- end }}
