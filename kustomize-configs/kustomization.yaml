---
apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component
## skip_validation: true

transformers:
  ## replace all references to ManagedClusterSet with the name of the ManagedClusterSet created for this environment
  - ./set-clusterset-references.yml

configurations:
  ## configure kustomize to correct the name of the PolicySet in the placement binding
  - ./policyset-namereference.yml
  ## configure kustomize to correct the name of the Policy namespace in the Policy dependency
  - ./namespace-namereference.yml

## ensure all policies have the copyPolicyMetadata set to false, unset the toplevel remediation action.
patches:
  - target:
      kind: Policy
    patch: |
      - op: add
        path: /spec/copyPolicyMetadata
        value: false
